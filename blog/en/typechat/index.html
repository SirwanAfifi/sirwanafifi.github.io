<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.5.4"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://sirwan.info/blog/en/typechat/"><!-- Primary Meta Tags --><title>آشنایی با TypeChat</title><meta name="title" content="آشنایی با TypeChat"><meta name="description" content="در دنیای Generative AI مفهوم Prompt نقش خیلی مهمی را ایفا میکند؛ چون برای گرفتن یک خروجی با کیفیت میبایست یک ورودی یا Prompt با کیفیت و خلاقانه داشته باشیم؛ این قضیه به قدری اهمیت دارد که یک عنوان شغلی هم برای آن در نظر گرفته شده است Prompt Engineer؛ چون اگر یک Prompt به خوبی نوشته نشود، نتایج غیرواقعی و نادرستی میتواند تولید کند که به این رفتار [Hallucination](https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)) یا Fabulations گفته میشود."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://sirwan.info/blog/en/typechat/"><meta property="og:title" content="آشنایی با TypeChat"><meta property="og:description" content="در دنیای Generative AI مفهوم Prompt نقش خیلی مهمی را ایفا میکند؛ چون برای گرفتن یک خروجی با کیفیت میبایست یک ورودی یا Prompt با کیفیت و خلاقانه داشته باشیم؛ این قضیه به قدری اهمیت دارد که یک عنوان شغلی هم برای آن در نظر گرفته شده است Prompt Engineer؛ چون اگر یک Prompt به خوبی نوشته نشود، نتایج غیرواقعی و نادرستی میتواند تولید کند که به این رفتار [Hallucination](https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)) یا Fabulations گفته میشود."><meta property="og:image" content="https://sirwan.info/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://sirwan.info/blog/en/typechat/"><meta property="twitter:title" content="آشنایی با TypeChat"><meta property="twitter:description" content="در دنیای Generative AI مفهوم Prompt نقش خیلی مهمی را ایفا میکند؛ چون برای گرفتن یک خروجی با کیفیت میبایست یک ورودی یا Prompt با کیفیت و خلاقانه داشته باشیم؛ این قضیه به قدری اهمیت دارد که یک عنوان شغلی هم برای آن در نظر گرفته شده است Prompt Engineer؛ چون اگر یک Prompt به خوبی نوشته نشود، نتایج غیرواقعی و نادرستی میتواند تولید کند که به این رفتار [Hallucination](https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)) یا Fabulations گفته میشود."><meta property="twitter:image" content="https://sirwan.info/blog-placeholder-1.jpg"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><style>
			main {
				:not(:has(code)) {
					direction: rtl;
					text-align: right;
				}
			}
		</style><link rel="stylesheet" href="/assets/about.qaUa4EmS.css" />
<link rel="stylesheet" href="/assets/about.AuQ71kM2.css" />
<style>a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}
footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
</style><script type="module" src="/assets/hoisted.rJsYUrLj.js"></script></head> <body class="bg-white antialiased dark:bg-zinc-900"> <header class="mb-30"> <nav class="w-full z-20 top-0 start-0 border-b border-gray-200 text-white dark:text-emerald-400"> <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4"> <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse"></a> <div class="flex md:order-2 space-x-3 md:space-x-0 rtl:space-x-reverse"></div> <div class="items-center justify-between w-full md:flex md:w-auto md:order-1"> <ul class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0"> <li> <a href="/about" data-astro-cid-eimmu3lg> درباره </a>  </li><li> <a href="/blog/fa" data-astro-cid-eimmu3lg> وبلاگ </a>  </li><li> <a href="/" data-astro-cid-eimmu3lg> خانه </a>  </li> </ul> </div> </div> </nav> </header> <main> <article>  <div class="prose m-auto p-4"> <div class="title"> <div class="date">  </div> <h1 class="block gradient-title-fa">آشنایی با TypeChat</h1> <hr class="m-2"> </div> <div class="space-x-1 text-sm dark:text-gray-500 mb-2 flex flex-wrap items-center"> ۱۱ ماه پیش - &nbsp;<time datetime="2023-08-18T23:46:37.121Z">۲۸ مرداد ۱۴۰۲</time> </div> <div class="tags"> <span class="dark:text-gray-400 text-xs font-medium me-2 px-2.5 py-0.5 rounded border-dashed border-2 border-emerald-500">TypeScript</span><span class="dark:text-gray-400 text-xs font-medium me-2 px-2.5 py-0.5 rounded border-dashed border-2 border-emerald-500">GPT</span><span class="dark:text-gray-400 text-xs font-medium me-2 px-2.5 py-0.5 rounded border-dashed border-2 border-emerald-500">OpenAI</span><span class="dark:text-gray-400 text-xs font-medium me-2 px-2.5 py-0.5 rounded border-dashed border-2 border-emerald-500">AI</span> </div> <section class="main-body text-zinc-600 dark:text-zinc-400">  <p>در دنیای Generative AI مفهوم Prompt نقش خیلی مهمی را ایفا میکند؛ چون برای گرفتن یک خروجی با کیفیت میبایست یک ورودی یا Prompt با کیفیت و خلاقانه داشته باشیم؛ این قضیه به قدری اهمیت دارد که یک عنوان شغلی هم برای آن در نظر گرفته شده است Prompt Engineer؛ چون اگر یک Prompt به خوبی نوشته نشود، نتایج غیرواقعی و نادرستی میتواند تولید کند که به این رفتار <a href="https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)">Hallucination</a> یا Fabulations گفته میشود. برای این LLMها دادن کانتکست اهمیت زیادی دارد چون یک Prompt به تنهایی پاسخ مطلوب را برایمان جنریت نمیکند و باید تا جایی که امکان دارد توضیحات کافی را بدهیم. به صورت پیش‌فرض هم همه در دادن instruction خوب نیستند و این خودش یک مهارت محسوب میشه بخاطر همین است که Prompt Engineering مطرح میشود. OpenAI هم یکسری Best Practise برای نوشتن Promptهای خوب دارد که از <a href="https://help.openai.com/en/collections/3675942-prompt-engineering">اینجا</a> یا <a href="https://cloud.google.com/blog/products/application-development/five-best-practices-for-prompt-engineering">اینجا</a> میتوانید مشاهده کنید. به عنوان مثال برای ChatGPT با تغییر کوچکی در نحوه پرسیدن سوال نتایج خیلی متفاوتی دریافت خواهیم کرد. ایده‌هایی که بهتر است به کار بگیریم:</p>
<p><strong>دادن نقش یا Personas</strong></p>
<p>مثلاً با عباراتی از قبیل act as a… میتوانیم یک نقش برای پاسخ تعیین کنیم.</p>
<p>​ Act as a marketing copywriter, and write three ads for…</p>
<p><strong>تعیین Tone</strong></p>
<p>مثلاً میتوانیم تعیین کنیم که خروجی که تولید میشود چه tone داشته باشد:</p>
<p>​ Use a friendly and inviting tone…</p>
<p>نکته‌ایی که در مورد این LLMها وجود دارد این است که در تولید متن به صورت پیش‌فرض عالی هستند در واقع بیشترین کاربرد آنها در تبدیل یک متن به یک متن دیگر است یعنی یک نوع text to text transformation هستند. این شاید نیاز خیلی‌ها را برطرف کند اما اگر خروجی را بخواهیم درون یک application code استفاده کنیم چطور؟ قاعدتاً میبایست خروجی متن را پارز کنیم که خود این فرآیند چالش‌های خاص خودش را دارد. اخیراً یک پروژه جالب از Microsoft با نام <a href="https://github.com/microsoft/TypeChat">TypeChat</a> منتشر شده است که دقیقاً همینکار را انجام میدهد؛ با کمک TypeScript میتوانیم فرمت یا اسکیمای خروجی موردنظرمان را از این LLMها درخواست کنیم. خوبی داستان این است که بیشتر این LLMها خیلی خوب با TypeScript و JSON آشنا هستند. در نتیجه به راحتی میتوانیم خروجی JSON تولید شده توسط این LLMها را درون کدهایمان استفاده کنیم؛ در اینحالت اپلیکیشن ما به جای سروکار داشتن با یک دیتای unstructured با یک ساختار مشخص یا structured سروکار خواهد داشت. مزیت TypeScript نیز این است که خیلی نسبت به JSON Schema به اصطلاح compactتر است؛ چیزی حدود ۵ برابر compactتر است.</p>
<p>برای استفاده از TypeChat نیاز به API Key یکی از سرویس‌های Azure OpenAI یا Open AI خواهید داشت. برای APIیی که OpenAI ارائه میدهد نیاز به یک اشتراک داریم که البته با اشتراک ChatGPT متفاوت است و آن را باید جدا تهیه کرد؛ برای محاسبه هزینه استفاده از این API میتواند از این <a href="https://gptforwork.com/tools/openai-chatgpt-api-pricing-calculator">لینک</a> کمک بگیرید. در ادامه میخواهیم یک پروژه ساده Node/TypeScript درست کنیم که کاربر با وارد کردن Prompt بتواند یک جدول درون یک دیتابیس MySQL ایجاد کند؛ برای اینکار اسکیمای مدنظرم را با کمک TypeScript تعیین میکنم؛ در واقع میخواهیم خروجی پاسخی که از LLM برای جنریت میکند را مشخص کنیم:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> interface</span><span style="color:#B392F0"> DatabaseSchema</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  databaseName</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  tables</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Table</span><span style="color:#E1E4E8">[];</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> interface</span><span style="color:#B392F0"> Table</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  name</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  columns</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Column</span><span style="color:#E1E4E8">[];</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> interface</span><span style="color:#B392F0"> Column</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  name</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  type</span><span style="color:#F97583">:</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "BIT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "TINYINT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "SMALLINT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "MEDIUMINT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "INT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "INTEGER"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "BIGINT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "REAL"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "DOUBLE"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "FLOAT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "DECIMAL"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "NUMERIC"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "DATE"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "TIME"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "TIMESTAMP"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "DATETIME"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "VARCHAR(255)"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "TEXT"</span></span>
<span class="line"><span style="color:#F97583">    |</span><span style="color:#9ECBFF"> "JSON"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  allowNull</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> boolean</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>بنابراین اگر یک Prompt اینچنینی داشته باشیم:</p>
<blockquote>
<p>I want a table called ‘Employee’ with these columns: ‘EmployeeID’, ‘FirstName’, ‘LastName’, ‘DepartmentID’, ‘DepartmentName’, ‘ManagerID’, ‘ManagerName’.</p>
</blockquote>
<p>خروجی زیر برایمان مطابق با اسکیمایی که تعریف کردیم جنریت خواهد شد:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#79B8FF">  "databaseName"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">  "tables"</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#79B8FF">      "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Employee"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">      "columns"</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"EmployeeID"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"INT"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"FirstName"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"VARCHAR(255)"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"LastName"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"VARCHAR(255)"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"DepartmentID"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"INT"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"DepartmentName"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"VARCHAR(255)"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"ManagerID"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"INT"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        },</span></span>
<span class="line"><span style="color:#E1E4E8">        {</span></span>
<span class="line"><span style="color:#79B8FF">          "name"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"ManagerName"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "type"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"VARCHAR(255)"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#79B8FF">          "allowNull"</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">      ]</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  ]</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>با خروجی فوق به راحتی میتوانیم توسط هر ORM جدول مدنظر را درون دیتابیس‌مان ایجاد کنیم؛ مزیت TypeChat این است که یک نوع validator نیز دارد یعنی اگر خروجی LLM مطابق اسکیمای تعریف شده نباشد یک خطا صادر خواهد شد. در ادامه کدهای مثال فوق را مشاهده میکنید:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#79B8FF"> *</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> fs </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "fs"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#79B8FF"> *</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> path </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "path"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dotenv </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "dotenv"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#79B8FF"> *</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> typechat </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "typechat"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { DatabaseSchema } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "./schema"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> knex </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "knex"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">dotenv.</span><span style="color:#B392F0">config</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#79B8FF"> Database</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> knex</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">  client: </span><span style="color:#9ECBFF">"mysql2"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  connection: {</span></span>
<span class="line"><span style="color:#E1E4E8">    host: process.env.</span><span style="color:#79B8FF">DATABASE_HOST</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    port: </span><span style="color:#B392F0">Number</span><span style="color:#E1E4E8">(process.env.</span><span style="color:#79B8FF">DATABASE_PORT</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">    user: process.env.</span><span style="color:#79B8FF">DATABASE_USER</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    password: process.env.</span><span style="color:#79B8FF">DATABASE_PASSWORD</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    database: process.env.</span><span style="color:#79B8FF">DATABASE_NAME</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">  },</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> model</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> typechat.</span><span style="color:#B392F0">createLanguageModel</span><span style="color:#E1E4E8">(process.env);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> schema</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> fs.</span><span style="color:#B392F0">readFileSync</span><span style="color:#E1E4E8">(path.</span><span style="color:#B392F0">join</span><span style="color:#E1E4E8">(__dirname, </span><span style="color:#9ECBFF">"schema.ts"</span><span style="color:#E1E4E8">), </span><span style="color:#9ECBFF">"utf8"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> translator</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> typechat.</span><span style="color:#B392F0">createJsonTranslator</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">DatabaseSchema</span><span style="color:#E1E4E8">>(</span></span>
<span class="line"><span style="color:#E1E4E8">  model,</span></span>
<span class="line"><span style="color:#E1E4E8">  schema,</span></span>
<span class="line"><span style="color:#9ECBFF">  "DatabaseSchema"</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">typechat.</span><span style="color:#B392F0">processRequests</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"😀> "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"./input.txt"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">request</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    await</span><span style="color:#E1E4E8"> Database.</span><span style="color:#B392F0">raw</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"SELECT 1"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> response</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> translator.</span><span style="color:#B392F0">translate</span><span style="color:#E1E4E8">(request);</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">response.success) {</span></span>
<span class="line"><span style="color:#E1E4E8">      console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(response.message);</span></span>
<span class="line"><span style="color:#F97583">      return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">JSON</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">stringify</span><span style="color:#E1E4E8">(response.data, </span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">));</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">tables</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> response.data;</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">const</span><span style="color:#79B8FF"> table</span><span style="color:#F97583"> of</span><span style="color:#E1E4E8"> tables) {</span></span>
<span class="line"><span style="color:#F97583">      const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">name</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">columns</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> table;</span></span>
<span class="line"><span style="color:#F97583">      let</span><span style="color:#79B8FF"> CREATE_TABLE</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> `CREATE TABLE IF NOT EXISTS ${</span><span style="color:#E1E4E8">name</span><span style="color:#9ECBFF">} (`</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">      for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">const</span><span style="color:#79B8FF"> column</span><span style="color:#F97583"> of</span><span style="color:#E1E4E8"> columns) {</span></span>
<span class="line"><span style="color:#F97583">        const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">name</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">type</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">allowNull</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> column;</span></span>
<span class="line"><span style="color:#79B8FF">        CREATE_TABLE</span><span style="color:#F97583"> +=</span><span style="color:#9ECBFF"> `</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">  ${</span><span style="color:#E1E4E8">name</span><span style="color:#9ECBFF">} ${</span><span style="color:#E1E4E8">type</span><span style="color:#9ECBFF">}${</span><span style="color:#E1E4E8">allowNull</span><span style="color:#F97583"> ?</span><span style="color:#9ECBFF"> ""</span><span style="color:#F97583"> :</span><span style="color:#9ECBFF"> " NOT NULL"},`</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#79B8FF">      CREATE_TABLE</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> CREATE_TABLE</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">slice</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">+</span><span style="color:#9ECBFF"> ");"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">      await</span><span style="color:#E1E4E8"> Database.</span><span style="color:#B392F0">raw</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">CREATE_TABLE</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  } </span><span style="color:#F97583">catch</span><span style="color:#E1E4E8"> (error) {</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(error);</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span></code></pre>
<p>کدهای کامل مثال فوق را نیز از <a href="https://github.com/SirwanAfifi/typechat-test">اینجا</a> میتوانید دریافت کنید.</p>  </section> <hr> </div> </article> </main> <footer data-astro-cid-sz7xmlte> <span class="text-zinc-600 dark:text-zinc-400" data-astro-cid-sz7xmlte>
&copy; 2024 Sirwan Afifi. All rights reserved.
</span> <div class="social-links" data-astro-cid-sz7xmlte> <a href="https://twitter.com/SirwanAfifi" target="_blank" data-astro-cid-sz7xmlte> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" class="fill-zinc-500 hover:fill-white transition-colors duration-200" data-astro-cid-sz7xmlte><path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/SirwanAfifi" target="_blank" data-astro-cid-sz7xmlte> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" class="fill-zinc-500 hover:fill-white tr" data-astro-cid-sz7xmlte><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </body></html>