{"componentChunkName":"component---src-templates-blog-details-js","path":"/blog/en/os-notification","result":{"data":{"markdownRemark":{"timeToRead":3,"frontmatter":{"date":"May 19th, 2021","title":"OS Notification","tags":["macOS","Windows","AppleScript","Powershell"],"slug":"OS-Notification"},"html":"<p>I recently tweeted something about a little script I had put together to automate one of the tasks I had always struggle with. I thought it would be a good idea to share the process in a little bit more detail:</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"fa\" dir=\"rtl\">کلاً خیلی علاقه دارم کارهای روتین‌ رو اتوماتیک کنم، یه مدته یه schedule task نوشتم که هر نیم ساعت یکبار بهم هشدار میده که زیاد پشت کامپیوتر نباشم و کمی قدم بزنم؛ الان هم نوتیفیکشن میده هم یه خانم با لهجه‌ی بریتیش و صدای زیباش بهم یادآوری میکنه 😀 <a href=\"https://t.co/E7RneW9W28\">pic.twitter.com/E7RneW9W28</a></p>&mdash; Sirwan Afifi (@SirwanAfifi) <a href=\"https://twitter.com/SirwanAfifi/status/1393528573013680128?ref_src=twsrc%5Etfw\">May 15, 2021</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<p>The tweet is in Persian but the gist of it is that like many programmers, I am really into automating things to make the most of my working day, at the same time I have been a little bit lazy recently in terms of doing regular exercises as I used to go walking a few times a week. Since I do things on the spur of the moment so I decided to give it a try right off the bat to remedy the problem.</p>\n<p>What I ended up with was to get my computer to help me out on this process by putting together a simple script to show me a notification every X times a day simply saying this:</p>\n<img class=\"img-res m-auto\" src=\"/img/mac_reminder.png\" alt=\"Mac OS Reminder\" />\n<p>Well, as I mentioned I am out of practice at walking so I can at least stand up a few times a day :D It simply reminds to do the activity so that it doesn't slip my mind.</p>\n<h2>MacOS</h2>\n<p>Initiating that notification is incredibly easy. If you are on mac you can open your terminal and type in this command:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`osascript -e 'display notification &quot;Hey boss, code is enough, Could you please stand up and move around for at least one minute?&quot; with title &quot;Reminder!&quot;'`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">osascript <span class=\"token operator\">-</span>e <span class=\"token string\">'display notification \"Hey boss, code is enough, Could you please stand up and move around for at least one minute?\" with title \"Reminder!\"'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>What it does is simply running a script which is called <a href=\"https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html\">AppleScript</a>. It comes out of the box with your operating OS so that you don't need to install something. It's basically a way to automate things in macOS. It also supports JavaScript, The following code has the exact same result:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`var app = Application.currentApplication()\n\napp.includeStandardAdditions = true\n\napp.displayNotification(&quot;Reminder&quot;, {\n  withTitle: &quot;Reminder&quot;,\n  subtitle:\n    &quot;Hey boss, code is enough, Could you please stand up and move around for at least one minute?&quot;,\n  soundName: &quot;Frog&quot;,\n})`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span><span class=\"token function\">currentApplication</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span>includeStandardAdditions <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">displayNotification</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Reminder\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">withTitle</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Reminder\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">subtitle</span><span class=\"token operator\">:</span>\n    <span class=\"token string\">\"Hey boss, code is enough, Could you please stand up and move around for at least one minute?\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">soundName</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Frog\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Windows</h2>\n<p>You can do the same thing on Windows:</p>\n<img class=\"img-res m-auto\" src=\"/img/windows_reminder.jpeg\" alt=\"Windows OS Reminder\" />\n<p>Which can be done using Powershell (You can also use <a href=\"https://sirwan.info/blog/en/running-powershell-on-macos\">Powershell on macOS</a>):</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`Add-Type -AssemblyName System.Windows.Forms\n\\$global:reminder = New-Object System.Windows.Forms.NotifyIcon\n\\$path = (Get-Process -id \\$pid).Path\n\\$reminder.Icon = [System.Drawing.Icon]::ExtractAssociatedIcon(\\$path)\n\\$reminder.BalloonTipIcon = [System.Windows.Forms.ToolTipIcon]::Info\n\\$reminder.BalloonTipText = ‘Hey boss, code is enough, Could you please stand up and move around for at least one minute?'\n\\$reminder.BalloonTipTitle = &quot;Reminder! \\$Env:USERNAME&quot;\n\\$reminder.Visible = \\$true\n\\$reminder.ShowBalloonTip(20000)`, ``)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-powershell line-numbers\"><code class=\"language-powershell\"><span class=\"token function\">Add-Type</span> <span class=\"token operator\">-</span>AssemblyName System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms\n<span class=\"token variable\">$global</span>:reminder = <span class=\"token function\">New-Object</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>NotifyIcon\n<span class=\"token variable\">$path</span> = <span class=\"token punctuation\">(</span><span class=\"token function\">Get-Process</span> <span class=\"token operator\">-</span>id <span class=\"token variable\">$pid</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Path\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>Icon = <span class=\"token namespace\">[System.Drawing.Icon]</span>::ExtractAssociatedIcon<span class=\"token punctuation\">(</span><span class=\"token variable\">$path</span><span class=\"token punctuation\">)</span>\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>BalloonTipIcon = <span class=\"token namespace\">[System.Windows.Forms.ToolTipIcon]</span>::Info\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>BalloonTipText = ‘Hey boss<span class=\"token punctuation\">,</span> code is enough<span class=\"token punctuation\">,</span> Could you please stand up and <span class=\"token function\">move</span> around <span class=\"token keyword\">for</span> at least one minute?'\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>BalloonTipTitle = <span class=\"token string\">\"Reminder! <span class=\"token variable\">$Env</span>:USERNAME\"</span>\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>Visible = <span class=\"token boolean\">$true</span>\n<span class=\"token variable\">$reminder</span><span class=\"token punctuation\">.</span>ShowBalloonTip<span class=\"token punctuation\">(</span>20000<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The code is self-explanatory, it instantiates an object of type <code class=\"language-text\">NotifyIcon</code> and sets some properties to display it on the screen.</p>\n<h2>How to Schedule the Task to Run Every 30 Minutes?</h2>\n<p>We can execute the task automatically every 30 minutes. It's pretty easy on both platforms. On Windows we can use Task Scheduler and on macOS we can use cron tab.</p>\n<h3>Windows</h3>\n<ol>\n<li>\n<p>Open <code class=\"language-text\">Task scheduler</code> > <code class=\"language-text\">Action</code> > <code class=\"language-text\">Create Task</code>.</p>\n</li>\n<li>\n<p>Choose a new for the task: <code class=\"language-text\">Reminder</code>.</p>\n</li>\n<li>\n<p>Go to <code class=\"language-text\">Triggers</code> tab > Click on <code class=\"language-text\">New...</code> button.</p>\n</li>\n<li>\n<p>Check <code class=\"language-text\">Repeat task every: 30 minutes</code>. > OK\n<img class=\"img-res w-2/3 m-auto\" src=\"/img/notification_windows_new_trigger.jpg\" alt=\"Windows OS Reminder\" /></p>\n</li>\n<li>\n<p>Go to <code class=\"language-text\">Actions</code> tab > Click on <code class=\"language-text\">New...</code></p>\n<ul>\n<li><code class=\"language-text\">Program/script</code>: <code class=\"language-text\">C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe</code></li>\n<li><code class=\"language-text\">Add arguments (optional)</code>: <code class=\"language-text\">-File \"C:\\Users\\Sirwan\\Desktop\\scripts\\reminder.ps1\"</code></li>\n</ul>\n</li>\n</ol>\n<img class=\"img-res w-2/3 m-auto\" src=\"/img/notification_windows_new_action.jpg\" alt=\"Windows OS Reminder\" />\n<h3>macOS</h3>\n<ol>\n<li>Open your terminal and type in this command: <code class=\"language-text\">crontab -e</code></li>\n<li>Paste the following command then <code class=\"language-text\">:wq</code>:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">*/30 * * * * osascript -e 'display notification \"Hey boss, code is enough, Could you please stand up and move around for at least one minute?\" with title \"Reminder!\"'</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"3\">\n<li>You might get this confirmation after saving the cron. Click OK to allow</li>\n</ol>\n<img class=\"img-res w-2/3 m-auto\" src=\"/img/notification_macos_cron_permission.jpg\" alt=\"Mac OS Reminder\" />"}},"pageContext":{"slug":"OS-Notification"}},"staticQueryHashes":[]}